name: steps-result-if-else
on: workflow_dispatch
jobs:
  e2etest:
    runs-on: ubuntu-latest
    steps:
      - name: First step
        id: first-step
        run: |
          echo "Hello World"
          exit 1

      - name: Second step
        id: second-step
        run: |
          echo "Hello World"
          exit 1

      - name: Third Step
        id: third-step
        run: |
          echo "Hello World"
          exit 1

      - name: Result step
        id: result-step
        if: always()
        run: |
          declare -a failed_array=()
          echo "First step outcome ${{ steps.first-step.outcome }}"
          echo "second step outcome ${{ steps.second-step.outcome }}"
          if [[ '${{ steps.first-step.outcome }}' == 'failure' ]]; then
            # echo "FAILED_STEP=first-step" >> $GITHUB_OUTPUT 
            failed_array+=("First step")
          fi
          if [[ ${{ steps.second-step.outcome }} == 'failure' || ${{ steps.second-step.outcome }} == 'skipped' ]]; then
            # echo "FAILED_STEP=second-step" >> $GITHUB_OUTPUT 
            failed_array+=("Second step")
          fi
          if [[ ${{ steps.third-step.outcome }} == 'failure' || ${{ steps.third-step.outcome }} == 'skipped' ]]; then
            # echo "FAILED_STEP=third-step" >> $GITHUB_OUTPUT 
            failed_array+=("Third step")
          fi
          echo "Updated array: ${failed_array[@]}"

      - name: Output of failed step
        if: always()
        run: |  
          echo "${{steps.result-step.outputs.FAILED_STEP}}"
